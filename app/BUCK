android_resource(
    name = "res_main",
    package = "org.wikipedia",
    res = "src/main/res",
    deps = [
        "//app/libs/com/google/android/material/material:material",
    ],
)

android_resource(
    name = "res_extra",
    package = "org.wikipedia",
    res = "src/extra/res",
    deps = [
        "//app/libs/com/google/android/material/material:material",
        ":res_main",
    ],
)

android_manifest(
    name = "android_manifest",
    skeleton = "src/main/AndroidManifest.xml",
)

android_binary(
    name = "app",
    keystore = "//keystores:debug",
    manifest = ":android_manifest",
    min_sdk_version = 21,
    disable_pre_dex = True,
    use_split_dex = True,
    deps = [":lib"],
)

android_build_config(
    name = "build_config",
    package = "org.wikipedia",
    values = [
        'boolean DEBUG = true',
        'String APPLICATION_ID = "org.wikipedia.dev"',
        'String BUILD_TYPE = "debug"',
        'String FLAVOR = "dev"',
        'int VERSION_CODE = 50542',
        'String VERSION_NAME = "2.7.50542-dev-2025-08-01"',
        'String DEFAULT_RESTBASE_URI_FORMAT = "%%1$s://%%2$s/api/rest_v1/"',
        'String EVENTGATE_ANALYTICS_EXTERNAL_BASE_URI = "https://intake-analytics.wikimedia.beta.wmflabs.org"',
        'String EVENTGATE_LOGGING_EXTERNAL_BASE_URI = "https://intake-logging.wikimedia.beta.wmflabs.org"',
        'String META_WIKI_BASE_URI = "https://meta.wikimedia.beta.wmflabs.org"',
        'String TEST_LOGIN_PASSWORD = "Bar"',
        'String TEST_LOGIN_USERNAME = "Foo"',
    ]
)

android_library(
    name = "lib",
    srcs = glob(["src/main/java/**/*", "src/extra/**/*", "src/debug/**/*"]),
    language = "KOTLIN",
    java_version = "17",
    k2 = True,
    extra_arguments = [
        "-XDstringConcat=inline",
    ],
    annotation_processor_params = [
        "room.schemaLocation=/Users/b41z33d/wikipedia/fbsource/apps-android-wikipedia-copy/app/schemas",
    ],
    annotation_processors = [
        "androidx.room.RoomProcessor",
    ],
    annotation_processor_deps = [
        "//app/libs/androidx/room/room-compiler:room-compiler",
    ],
    kotlin_compiler_plugins = {
        "//app/libs/org/jetbrains/kotlin/kotlin-compose-compiler-plugin-embeddable:kotlin-compose-compiler-plugin-embeddable": {},
        "//app/libs/org/jetbrains/kotlin/kotlin-parcelize-compiler:kotlin-parcelize-compiler": {},
        "//app/libs/org/jetbrains/kotlin/kotlin-serialization:kotlin-serialization": {},
    },
    deps = [
        ":res_main",
        ":res_extra",
        ":build_config",
        "//app/libs/io/coil-kt/coil3/coil-core-android:coil-core-android",
        "//app/libs/org/jetbrains/kotlin/kotlin-stdlib:kotlin-stdlib",
        "//app/libs/androidx/preference/preference-ktx:preference-ktx",
        "//app/libs/org/maplibre/gl/android-sdk:android-sdk",
        "//app/libs/org/maplibre/gl/android-plugin-annotation-v9:android-plugin-annotation-v9",
        # "//app/libs/androidx/test/espresso/espresso-intents:espresso-intents",
        # "//app/libs/androidx/test/ext/junit:junit",
        "//app/libs/androidx/navigation/navigation-compose:navigation-compose",
        # "//app/libs/androidx/test/orchestrator:orchestrator",
        # "//app/libs/androidx/room/room-compiler:room-compiler",
        "//app/libs/androidx/room/room-ktx:room-ktx",
        "//app/libs/androidx/room/room-runtime:room-runtime",
        # "//app/libs/androidx/test/uiautomator/uiautomator:uiautomator",
        "//app/libs/com/github/skydoves/balloon:balloon",
        "//app/libs/androidx/browser/browser:browser",
        "//app/libs/io/coil-kt/coil3/coil-compose-android:coil-compose-android",
        "//app/libs/io/coil-kt/coil3/coil-gif:coil-gif",
        "//app/libs/io/coil-kt/coil3/coil-network-okhttp-jvm:coil-network-okhttp-jvm",
        "//app/libs/io/coil-kt/coil3/coil-svg-android:coil-svg-android",
        "//app/libs/com/google/android/gms/play-services-wallet:play-services-wallet",
        "//app/libs/com/google/firebase/firebase-messaging-ktx:firebase-messaging-ktx",
        "//app/libs/com/google/mlkit/language-id:language-id",
        "//app/libs/org/apache/commons/commons-lang3:commons-lang3",
        "//app/libs/androidx/constraintlayout/constraintlayout:constraintlayout",
        "//app/libs/androidx/core/core-ktx:core-ktx",
        "//app/libs/androidx/appcompat/appcompat:appcompat",
        "//app/libs/com/android/tools/desugar_jdk_libs:desugar_jdk_libs",
        "//app/libs/androidx/drawerlayout/drawerlayout:drawerlayout",
        # "//app/libs/androidx/test/espresso/espresso-contrib:espresso-contrib",
        # "//app/libs/androidx/test/espresso/espresso-core:espresso-core",
        # "//app/libs/androidx/test/espresso/espresso-web:espresso-web",
        "//app/libs/com/google/android/flexbox/flexbox:flexbox",
        "//app/libs/androidx/fragment/fragment-ktx:fragment-ktx",
        "//app/libs/com/google/gms/google-services:google-services",
        # "//app/libs/com/android/tools/build/gradle:gradle",
        # "//app/libs/org/hamcrest/hamcrest:hamcrest",
        "//app/libs/com/android/installreferrer/installreferrer:installreferrer",
        "//app/libs/org/jsoup/jsoup:jsoup",
        # "//app/libs/junit/junit:junit",
        # "//app/libs/org/jetbrains/kotlin/kotlin-gradle-plugin:kotlin-gradle-plugin",
        "//app/libs/org/jetbrains/kotlin/kotlin-serialization:kotlin-serialization",
        "//app/libs/org/jetbrains/kotlin/kotlin-stdlib-jdk8:kotlin-stdlib-jdk8",
        "//app/libs/org/jetbrains/kotlinx/kotlinx-coroutines-android:kotlinx-coroutines-android",
        "//app/libs/org/jetbrains/kotlinx/kotlinx-coroutines-core:kotlinx-coroutines-core",
        "//app/libs/org/jetbrains/kotlinx/kotlinx-serialization-json:kotlinx-serialization-json",
        "//app/libs/com/squareup/leakcanary/leakcanary-android:leakcanary-android",
        "//app/libs/com/google/android/material/material:material",
        "//app/libs/org/wikimedia/metrics/metrics-platform:metrics-platform",
        # "//app/libs/org/mockito/mockito-inline:mockito-inline",
        # "//app/libs/com/squareup/okhttp3/mockwebserver:mockwebserver",
        "//app/libs/com/squareup/okhttp3/okhttp-tls:okhttp-tls",
        "//app/libs/com/squareup/okhttp3/logging-interceptor:logging-interceptor",
        "//app/libs/com/squareup/okhttp3/okhttp:okhttp",
        "//app/libs/androidx/palette/palette-ktx:palette-ktx",
        "//app/libs/androidx/paging/paging-runtime-ktx:paging-runtime-ktx",
        "//app/libs/io/getstream/photoview:photoview",
        "//app/libs/com/squareup/leakcanary/plumber-android:plumber-android",
        "//app/libs/androidx/recyclerview/recyclerview:recyclerview",
        "//app/libs/com/squareup/retrofit2/retrofit:retrofit",
        "//app/libs/com/squareup/retrofit2/converter-kotlinx-serialization:converter-kotlinx-serialization",
        # "//app/libs/org/robolectric/robolectric:robolectric",
        # "//app/libs/androidx/room/room-testing:room-testing",
        "//app/libs/androidx/swiperefreshlayout/swiperefreshlayout:swiperefreshlayout",
        "//app/libs/androidx/viewpager2/viewpager2:viewpager2",
        "//app/libs/androidx/work/work-runtime-ktx:work-runtime-ktx",
        "//app/libs/androidx/activity/activity-compose:activity-compose",
        "//app/libs/androidx/lifecycle/lifecycle-viewmodel-compose:lifecycle-viewmodel-compose",
        "//app/libs/androidx/compose/material3/material3:material3",
        "//app/libs/androidx/compose/ui/ui:ui",
        "//app/libs/androidx/compose/ui/ui-tooling-preview:ui-tooling-preview",
        "//app/libs/androidx/compose/ui/ui-tooling:ui-tooling",
        "//app/libs/org/jetbrains/kotlin/kotlin-parcelize-runtime:kotlin-parcelize-runtime",
        "//app/libs/androidx/databinding/databinding-runtime:databinding-runtime",
    ],
)
